# LimeSurvey Health Alerts

# Alert when LimeSurvey HTTP endpoint is down
alarm: limesurvey_http_endpoint_down
   on: httpcheck_limesurvey_local.status
 calc: $success
units: up/down
every: 10s
 warn: $this == 0
 crit: $this == 0
delay: down 1m multiplier 1.5 max 1h
 info: LimeSurvey HTTP endpoint is not responding
   to: sysadmin

# Alert when LimeSurvey response time is high
alarm: limesurvey_response_time_high
   on: httpcheck_limesurvey_local.response_time
 calc: $time
units: ms
every: 10s
 warn: $this > 1000
 crit: $this > 3000
delay: up 2m down 5m multiplier 1.5 max 1h
 info: LimeSurvey response time is high (over 1 second)
   to: sysadmin

# Alert on high CPU usage for LimeSurvey container
alarm: limesurvey_container_cpu_high
   on: cgroup_limesurvey_app.cpu_limit
 calc: $used
units: %
every: 10s
 warn: $this > 80
 crit: $this > 95
delay: up 2m down 5m multiplier 1.5 max 1h
 info: LimeSurvey container CPU usage is high
   to: sysadmin

# Alert on high memory usage for LimeSurvey container
alarm: limesurvey_container_memory_high
   on: cgroup_limesurvey_app.mem_usage
 calc: $used * 100 / $limit
units: %
every: 10s
 warn: $this > 80
 crit: $this > 95
delay: up 2m down 5m multiplier 1.5 max 1h
 info: LimeSurvey container memory usage is high
   to: sysadmin

# Alert on high memory usage for Database container
alarm: database_container_memory_high
   on: cgroup_limesurvey_db.mem_usage
 calc: $used * 100 / $limit
units: %
every: 10s
 warn: $this > 80
 crit: $this > 95
delay: up 2m down 5m multiplier 1.5 max 1h
 info: Database container memory usage is high
   to: sysadmin
